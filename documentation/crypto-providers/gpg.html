<!-- last_modified_at:  --><!DOCTYPE html>
<html lang="en" data-appurl='https://fqa.test.signpath.io'>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="canonical" href='https://signpath.github.io/website-staging//documentation/crypto-providers/gpg' />
  <!-- Begin Jekyll SEO tag v2.6.1 -->
  <link rel='preload' as='style' href='/assets/css/line-awesome.min.css' onload="this.rel='stylesheet'">
  <title>Crypto Providers - GPG | SignPath</title>
  <meta property="og:title" content="Crypto Providers - GPG | SignPath" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:description" content="Creating GPG signatures with SignPath" />
  <meta property="og:url" content="https://signpath.github.io/website-staging//documentation/crypto-providers/gpg" />
  <meta property="og:site_name" content="SignPath - Code Signing Simple and Secure" />
  <meta name="description" content="Creating GPG signatures with SignPath"/>
  <!-- End Jekyll SEO tag -->
  <link rel='stylesheet' href='/assets/css/hint.min.css'>
  <link rel="stylesheet" href="/assets/css/index.css?cache=2024-02-22">
  <link rel="alternate" type="application/atom+xml" title="SignPath.io Blog" href="/feed.xml">
  <script src='/assets/index.js?cache=2024-03-07'></script>
  <script src='/assets/js/main-bundle.js?cache=2024-03-07'></script><link rel="icon" href="/assets/favicon-50x50.png" sizes="32x32">
  <link rel="icon" href="/assets/favicon.png" sizes="192x192">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.png">
  <meta name="msapplication-TileImage" content="/assets/favicon.png">
</head>
<body>
  <header>
    <div>
      <a href='/'><img src='/assets/signpath-logo-white.svg' width="181" height="36" alt='SignPath'></a>
      <nav>
        <ul><li>
              <a href='/product'> Product </a>
              <ul><li> <a href='/product/features'> Features </a> </li><li> <a href='/product/editions'> Editions </a> </li><li class='separator' /><li> <a href='/product/devops'> For DevOps teams </a> </li><li> <a href='/product/infosec'> For InfoSec teams </a> </li><li> <a href='/product/open-source'> For Open Source projects </a> </li><li class='separator' /><li> <a href='/product/office-macros'> Office macro signing </a> </li><li> <a href='/product/pkic-best-practices'> PKI Consortium best practices </a> </li></ul>
            </li><li>
              <a href='/code-signing'> Code Signing </a>
              <ul><li> <a href='/code-signing/introduction'> Introduction </a> </li><li> <a href='/code-signing/theory'> Theory </a> </li><li> <a href='/code-signing/windows-platform'> Windows Platform </a> </li><li> <a href='/code-signing/test-certificates'> Managing Test Certificates </a> </li><li> <a href='/code-signing/private-keys'> Storage of Private Keys </a> </li><li> <a href='/code-signing/media-coverage'> Media Coverage </a> </li></ul>
            </li><li>
              <a href='/documentation'> Documentation </a>
              <ul><li> <a href='/documentation/getting-started'> Getting Started </a> </li><li> <a href='/documentation/managing-certificates'> Managing Certificates </a> </li><li> <a href='/documentation/users'> Managing Users </a> </li><li> <a href='/documentation/projects'> Setting up Projects </a> </li><li> <a href='/documentation/signing-code'> Signing Code </a> </li><li> <a href='/documentation/signing-containers'> Signing Container Images </a> </li><li class='separator' /><li> <a href='/documentation/artifact-configuration'> Artifact Configuration </a> </li><li> <a href='/documentation/build-system-integration'> Build System Integration </a> </li><li> <a href='/documentation/trusted-build-systems'> Trusted Build Systems </a> </li><li> <a href='/documentation/origin-verification'> Origin Verification </a> </li><li class='separator' /><li> <a href='/documentation/powershell'> PowerShell cmdlets </a> </li><li> <a href='/documentation/crypto-providers'> Crypto Providers </a> </li><li class='separator' /><li> <a href='/documentation/changelog'> Product updates </a> </li></ul>
            </li><li>
              <a href='/about-us'> About us </a>
              <ul><li> <a href='/company'> Company </a> </li><li> <a href='/team'> Team </a> </li><li> <a href='/blog'> Blog </a> </li><li> <a href='/jobs'> Jobs </a> </li><li> <a href='/support'> Support </a> </li><li> <a href='/contact'> Contact </a> </li></ul>
            </li><li class='login'><a class='btn btn-flat' href='https://fqa.test.signpath.io/Web/Home/Login'>Login</a>
          <li class='login'><a href='https://fqa.test.signpath.io/Web/Subscription/StartFreeTrial' class='btn btn-primary trial'>Start free trial</a></li>
          </li>
        </ul>
        <a id='main-menu-toggle' href='#' onclick='document.querySelector("header > div > nav > ul").classList.toggle("open")'>
          <div></div>
          <div></div>
          <div></div>
        </a>
      </nav>
    </div>
  </header>
  <main>
<section class="bg-blue font-white top-section">
	<div>
		<h1><span class='no-break'>Crypto Providers &nbsp;❯&nbsp; </span> GPG</h1>
	</div>
</section>
<section class="resources-section">
	<div><aside>
				<ul><li class=''>
							<a href='/documentation/crypto-providers/#'>Crypto Providers</a></li><li class=''>
							<a href='/documentation/crypto-providers/windows#'>Windows CSP and KSP</a></li><li class=''>
							<a href='/documentation/crypto-providers/cryptoki#'>Cryptoki/PKCS#11</a></li><li class='active'>
							<a href='/documentation/crypto-providers/gpg#'>GPG</a><div class="no-mobile" ><ul>
  <li><a href="#general-instructions">General Instructions</a></li>
  <li><a href="#signing-code-with-gpg">Signing code with GPG</a></li>
</ul>
</div></li><li class=''>
							<a href='/documentation/crypto-providers/macos#'>macOS CryptoTokenKit</a></li><li class=''>
							<a href='/documentation/crypto-providers/rest-api#'>REST API</a></li></ul>
			</aside><article><ul class="article-toc">
  <li><a href="#general-instructions">General Instructions</a>
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#setup">Setup</a></li>
    </ul>
  </li>
  <li><a href="#signing-code-with-gpg">Signing code with GPG</a>
    <ul>
      <li><a href="#gpg-file-signing">GPG File Signing</a></li>
      <li><a href="#rpm-signing-linux">RPM Signing (Linux)</a></li>
      <li><a href="#deb-signing-via-dpkg-sig-linux">DEB Signing via dpkg-sig (Linux)</a></li>
      <li><a href="#maven-artifact-signing-linux">Maven Artifact Signing (Linux)</a></li>
    </ul>
  </li>
</ul>
<h2 id="general-instructions">General Instructions</h2>

<p><a href="https://gnupg.org/">Gnu Privacy Guard</a>, also known as GPG or GnuPG, is an Open Source implementation of the OpenPGP standard. This section provides information about using GPG with SignPath, as well as some code signing tools that build on GPG.</p>

<h3 id="overview">Overview</h3>

<p>GnuPG does not directly support the PKCS #11/Cryptoki interface. The <a href="https://github.com/alonbl/gnupg-pkcs11-scd/">gnupg-pkcs11-scd</a> project adds this capability as a daemon for the GnuPG <a href="https://wiki.gnupg.org/SmartCard">“Smartcard”</a> interface.</p>

<p><img src="/assets/img/resources/documentation/crypto-providers/gpg-signing-flow.svg" alt="Figure: GPG signing flow" /></p>

<h3 id="setup">Setup</h3>

<h4 id="configure-gnupg">Configuring GnuPG</h4>

<p>Configure the <a href="/documentation/crypto-providers/cryptoki">SignPath Cryptoki provider</a> for</p>
<ul>
  <li>GnuPG in <code class="language-plaintext highlighter-rouge">gpg-agent.conf</code></li>
  <li>gnupg-pkcs11-scd in <code class="language-plaintext highlighter-rouge">gnupg-pkcs11-scd.conf</code></li>
</ul>

<p>For more details see</p>
<ul>
  <li><a href="/documentation/crypto-providers#crypto-provider-configuration">Crypto Provider configuration</a> documentation</li>
  <li><code class="language-plaintext highlighter-rouge">samples/Scenarios/Gpg</code> in the <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a> (details about configuration and necessary dependencies)</li>
</ul>

<h4 id="gpg-error-logs">Error logs</h4>

<p>For <code class="language-plaintext highlighter-rouge">gnupg-pkcs11-scd</code>, <code class="language-plaintext highlighter-rouge">stdout</code> console output must be disabled. Use the log files for troubleshooting.</p>

<p>For the <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a>, the following log file locations are configured:</p>

<ul>
  <li>SignPath Cryptoki logs: <code class="language-plaintext highlighter-rouge">samples/Scenarios/temp/SignPathLogs/*.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">gnupg-pkcs11</code> logs: <code class="language-plaintext highlighter-rouge">samples/Scenarios/temp/gnupg-pkcs11-scd.log</code></li>
  <li>GPG logs: <code class="language-plaintext highlighter-rouge">samples/Scenarios/temp/gpg-agent.log</code></li>
</ul>

<h4 id="gpg-key-generation">GPG Key Generation</h4>

<blockquote class="panel info">
  <p><strong>GPG terminology: public keys</strong></p>

  <p>GPG uses the term <em>public key</em> for a specific file format that includes the actual public key key, the holder’s identity (name, email address), expiration, and other data. It is therefore more similar to a certificate than just a public key.</p>

  <p>This sometimes creates confusion about whether the term public key refers to just the public part of the cryptographic key pair, or an entire GPG public key.</p>
</blockquote>

<p>To use GPG with SignPath, you need to create an X.509 certificate for the cryptographic key pair, and a separate GPG public key on your computer. The GPG public key will <em>contain</em> the cryptographic public key from the certificate and <em>reference</em> the private key, which will remain with SignPath.</p>

<p>The reference is implemented as a <a href="https://github.com/gpg/gnupg/blob/STABLE-BRANCH-2-2/agent/keyformat.txt#shadowed-private-key-format">“shadowed private key”</a> and references a SignPath <em>project</em> slug and <em>signing policy</em> slug. (It is stored in <code class="language-plaintext highlighter-rouge">$GNUPGHOME/private-keys-v1.d/$KeyGrip.key</code> and can be restored from the GPG public key.)</p>

<blockquote class="panel tip">
  <p><strong>Tip: Create a self-signed certificate in SignPath</strong></p>

  <p>We recommend that you create a self-signed certificate in SignPath for each GPG public key. While the certificate’s metadata is not used, you might want to use similar values as for the GPG public key for clarity.</p>

  <p>However, technically you can use any code signing certificate, including those issued by Certificate Authorities, with arbitrary metadata</p>
</blockquote>

<blockquote class="panel tip">
  <p><strong>Sample code to create a GPG public key</strong></p>

  <p>The <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a> contain scripts to generate a GPG key.</p>

  <p>Usage: <code class="language-plaintext highlighter-rouge">.\RunScenario.ps1 ... -Scenario GenerateGpgKey</code></p>

  <p>The following defaults are used:</p>
  <ul>
    <li>full name: <code class="language-plaintext highlighter-rouge">"SignPath $ProjectSlug / $SigningPolicySlug</code></li>
    <li>email: <code class="language-plaintext highlighter-rouge">"$SigningPolicySlug@$ProjectSlug</code></li>
    <li>expiration: 1 year</li>
  </ul>

  <p>See <code class="language-plaintext highlighter-rouge">GenerateGpgKey.ps1</code> for details how the different commands are parameterized and to change defaults.</p>

  <p>Result:</p>
  <ul>
    <li>A GPG key exported to <code class="language-plaintext highlighter-rouge">samples/Scenarios/Gpg/Keys</code> including the public key</li>
    <li>A corresponding revocation certificate in the <code class="language-plaintext highlighter-rouge">openpgp-revocs.d</code> subdirectory</li>
  </ul>

  <p>GPG key generation causes two SignPath hash signing operations:</p>
  <ul>
    <li>self-sign the key</li>
    <li>sign the revocation certificate</li>
  </ul>

  <p>In case errors appear, check out the <a href="#gpg-error-logs">error logs</a>.</p>
</blockquote>

<h4 id="prepare-for-signing">Prepare for signing</h4>

<ol>
  <li>Copy the generated public GPG key (<code class="language-plaintext highlighter-rouge">$Email.public.pgp</code>) to the target system.</li>
  <li>Execute <code class="language-plaintext highlighter-rouge">SCD LEARN</code> to restore the shadowed keys. For details, see the <code class="language-plaintext highlighter-rouge">UseSignPathCryptokiGpgConfiguration</code> function in the GPG scenario of the <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a>.</li>
  <li>Import the GPG key . See the <code class="language-plaintext highlighter-rouge">ImportGpgKeys</code> function in the GPG scenario of the <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a>.</li>
</ol>

<h2 id="signing-code-with-gpg">Signing code with GPG</h2>

<h3 id="gpg-file-signing">GPG File Signing</h3>

<p>The <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a> contain a full example to sign and verify a file with a detached signature (including the mentioned preparation steps) in <code class="language-plaintext highlighter-rouge">.\RunScenario.ps1 ... -Scenario GpgSignFile</code>. The used GPG key is referenced via its email address.</p>

<p>During <code class="language-plaintext highlighter-rouge">gpg --sign</code>, SignPath is called to perform a hash based signing operation with the <em>Project</em> / <em>Signing Policy</em> referenced in the shadowed private key. Note that the <em>OrganizationId</em> and the <em>ApiToken</em> still need to be passed to the SignPath Crypto Provider to authenticate the request.</p>

<h3 id="rpm-signing-linux">RPM Signing (Linux)</h3>

<p>The <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a> contain a full example to sign and verify a RPM file in <code class="language-plaintext highlighter-rouge">.\RunScenario.ps1 ... -Scenario SignRpm</code>. The used GPG key is referenced via its email address. See <code class="language-plaintext highlighter-rouge">SignRpm.ps1</code> for details.</p>

<p>During <code class="language-plaintext highlighter-rouge">rpm --addsign</code>, SignPath is called to perform a hash based signing operation with the <em>Project</em> / <em>Signing Policy</em> referenced in the shadowed private key. Note that the <em>OrganizationId</em> and the <em>ApiToken</em> still need to be passed to the SignPath Crypto Provider to authenticate the request.</p>

<h3 id="deb-signing-via-dpkg-sig-linux">DEB Signing via dpkg-sig (Linux)</h3>

<p>The <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a> contain a full example to sign and verify a DEB file using <em><a href="https://manpages.debian.org/bullseye/dpkg-sig/dpkg-sig.1.en.html">dpkg-sig</a></em> in <code class="language-plaintext highlighter-rouge">.\RunScenario.ps1 ... -Scenario SignDeb</code>. The used GPG key is referenced via its email address. Note the passed default “sign role” value of <code class="language-plaintext highlighter-rouge">"builder"</code>.</p>

<p>During <code class="language-plaintext highlighter-rouge">dpkg-sig --sign</code>, SignPath is called to perform a hash based signing operation with the project / signing policy referenced in the shadowed private key. Note that OrganizationId and the ApiToken still need to be passed to the SignPath Crypto Provider to authenticate the request.</p>

<h3 id="maven-artifact-signing-linux">Maven Artifact Signing (Linux)</h3>

<p>The <a href="/documentation/crypto-providers#linux-docker-samples">Linux container samples</a> contain a full example to build, sign and verify Maven artifacts using the <em><a href="https://maven.apache.org/plugins/maven-gpg-plugin/">Apache maven-gpg-plugin</a></em> in <code class="language-plaintext highlighter-rouge">.\RunScenario.ps1 ... -Scenario SignMaven</code>. The used GPG key is referenced via its email address.</p>

<p>During <code class="language-plaintext highlighter-rouge">mvn install</code>, SignPath is called to perform a hash based signing operations with the <em>Project</em> / <em>Signing Policy</em> referenced in the shadowed private key. Note that the <em>OrganizationId</em> and the <em>ApiToken</em> still need to be passed to the SignPath Crypto Provider to authenticate the request.</p>


		</article>
	</div>
</section><!-- last_modified_at:  --><section class='bg-dark-grey font-white newsletter' id="newsletter">
	<div>
		<h2>Sign up for news and special offers</h2>
		<form class="ml-block-form" action="https://app.mailerlite.com/webforms/submit/d7c3i1" data-code="d7c3i1" method="post">
			<input type="text" class="form-control" data-inputmask="" name="fields[name]" value="" placeholder="Name">
			<input type="email" class="form-control" data-inputmask="" name="fields[email]" value="" placeholder="Email">
			<input type="hidden" name="ml-submit" value="1">
			<button type="submit" class="btn btn-secondary newsletter">Subscribe</button>
		</form>
	</div>
</section>
</main>
  <footer>
  	<div>
	  	<div>
	  		<img src='/assets/signpath-logo-white.svg' width="334" height="67" alt='SignPath'/>
	  		<svg viewBox="0 0 244 18">
			  <text x="0" y="15">CODE SIGNING SIMPLE &amp; SECURE</text>
			</svg>
	  		<div>
				<a target="_blank" href="https://www.linkedin.com/company/33243108" rel="noopener noreferrer">
<svg class="icon footer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor"  d="M 8.6425781 4 C 7.1835781 4 6 5.181625 6 6.640625 C 6 8.099625 7.182625 9.3085938 8.640625 9.3085938 C 10.098625 9.3085938 11.283203 8.099625 11.283203 6.640625 C 11.283203 5.182625 10.101578 4 8.6425781 4 z M 21.535156 11 C 19.316156 11 18.0465 12.160453 17.4375 13.314453 L 17.373047 13.314453 L 17.373047 11.310547 L 13 11.310547 L 13 26 L 17.556641 26 L 17.556641 18.728516 C 17.556641 16.812516 17.701266 14.960938 20.072266 14.960938 C 22.409266 14.960937 22.443359 17.145609 22.443359 18.849609 L 22.443359 26 L 26.994141 26 L 27 26 L 27 17.931641 C 27 13.983641 26.151156 11 21.535156 11 z M 6.3632812 11.310547 L 6.3632812 26 L 10.923828 26 L 10.923828 11.310547 L 6.3632812 11.310547 z"/></svg></a>
				&nbsp;&nbsp;
				<a target="_blank" href="mailto:info@signpath.io" rel="noopener noreferrer"><svg class="icon footer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 3 8 L 3 26 L 29 26 L 29 8 Z M 7.3125 10 L 24.6875 10 L 16 15.78125 Z M 5 10.875 L 15.4375 17.84375 L 16 18.1875 L 16.5625 17.84375 L 27 10.875 L 27 24 L 5 24 Z"/></svg>
</div>
	  	</div>
	  	<div>
	  		<a href='/privacy-policy'>Privacy Policy</a>
	  		<a href='/terms-of-service'>Terms of Service</a>
	  		<a href='/status'><span style="color: lightgreen;"><svg class="icon small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"/></svg>
</span>Status
			</a>
	  	</div>
	</div>
  </footer>
        <div id='cookie-info'>
            <h3>Cookie settings</h3>
            <div class="container">
                <span>We use cookies to enhance your browsing experience.</span>
                <p class="mobile show-more active"><a>Show more information</a></p>
                <p class="mobile show-less"><a>Show less information</a></p>
                <span class="information">By clicking the “Accept” button below, you agree that non-essential cookies on our website may be used by us and by third parties, some of them located in the USA. Learn more about our cookies in our <a
                            href='/privacy-policy'>Privacy
					Policy</a>
                </span>
				<div class="actions">
					<button class='btn btn-primary' id='acknowledge-cookies-btn'>Accept</button>
					<button class="btn btn-grey" id='refuse-cookies-btn'>Refuse</button>
				</div>
            </div>
			<script>
				const queryString = window.location.search;
				const urlParams = new URLSearchParams(queryString);
				const adgroupid = urlParams.get('adgroupid') ? urlParams.get('adgroupid') : document.cookie.match('(^|;)\\s*' + 'adgroupid' + '\\s*=\\s*([^;]+)')?.pop() || ''

				if (adgroupid) {
					const els_trial = document.querySelectorAll("a[href='" + window.location.protocol + '//' + window.location.hostname + '/Web/Subscription/StartFreeTrial' + "']")
					const els_login = document.querySelectorAll("a[href='" + window.location.protocol + '//' + window.location.hostname + '/Web/Home/Login' + "']");

					for (let child of els_trial) {
						if (child.tagName === 'A') {
							child.href = child.href + '?websiteCorrelationId=' + adgroupid
						}
					}

					for (let child of els_login) {
						if (child.tagName === 'A') {
							child.href = child.href + '?websiteCorrelationId=' + adgroupid
						}
					}
				}
			</script>
		</div>
	</footer>
</body>
</html>
