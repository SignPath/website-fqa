<!-- last_modified_at:  --><!DOCTYPE html>
<html lang="en" data-appurl='https://fqa.test.signpath.io'>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="canonical" href='https://signpath.github.io/website-staging//product/office-macros' />
  <!-- Begin Jekyll SEO tag v2.6.1 -->
  <link rel='preload' as='style' href='/assets/css/line-awesome.min.css' onload="this.rel='stylesheet'">
  <title>Microsoft Office Macro Signing | SignPath</title>
  <meta property="og:title" content="Microsoft Office Macro Signing | SignPath" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:description" content="Protecting from malicious Office macros through policy restrictions and signing" />
  <meta property="og:url" content="https://signpath.github.io/website-staging//product/office-macros" />
  <meta property="og:site_name" content="SignPath - Code Signing Simple and Secure" />
  <meta name="description" content="Protecting from malicious Office macros through policy restrictions and signing"/>
  <!-- End Jekyll SEO tag -->
  <link rel='stylesheet' href='/assets/css/hint.min.css'>
  <link rel="stylesheet" href="/assets/css/index.css?cache=2023-09-05">
  <link rel="alternate" type="application/atom+xml" title="SignPath.io Blog" href="/feed.xml">
  <script src='/assets/index.js?cache=2023-09-05'></script>
  <script src='/assets/js/main-bundle.js?cache=2023-09-05'></script><link rel="icon" href="/assets/favicon-50x50.png" sizes="32x32">
  <link rel="icon" href="/assets/favicon.png" sizes="192x192">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.png">
  <meta name="msapplication-TileImage" content="/assets/favicon.png">
</head>
<body>
  <header>
    <div>
      <a href='/'><img src='/assets/logo.svg' width="181" height="36" alt='SignPath'></a>
      <nav>
        <ul><li>
              <a href='/product'> Product </a>
              <ul><li> <a href='/product/features'> Features </a> </li><li> <a href='/product/editions'> Editions </a> </li><li class='separator' /><li> <a href='/product/devops'> For DevOps teams </a> </li><li> <a href='/product/infosec'> For InfoSec teams </a> </li><li> <a href='/product/open-source'> For Open Source projects </a> </li><li class='separator' /><li> <a href='/product/office-macros'> Office macro signing </a> </li><li> <a href='/product/pkic-best-practices'> PKI Consortium best practices </a> </li><li class='separator' /><li> <a href='/product/changelog'> Product updates </a> </li></ul>
            </li><li>
              <a href='/code-signing'> Code Signing </a>
              <ul><li> <a href='/code-signing/introduction'> Introduction </a> </li><li> <a href='/code-signing/theory'> Theory </a> </li><li> <a href='/code-signing/windows-platform'> Windows Platform </a> </li><li> <a href='/code-signing/test-certificates'> Managing Test Certificates </a> </li><li> <a href='/code-signing/private-keys'> Storage of Private Keys </a> </li><li> <a href='/code-signing/media-coverage'> Media Coverage </a> </li></ul>
            </li><li>
              <a href='/documentation'> Documentation </a>
              <ul><li> <a href='/documentation/getting-started'> Getting Started </a> </li><li> <a href='/documentation/managing-certificates'> Managing Certificates </a> </li><li> <a href='/documentation/users'> Managing Users </a> </li><li> <a href='/documentation/projects'> Setting up Projects </a> </li><li> <a href='/documentation/signing-code'> Signing Code </a> </li><li> <a href='/documentation/docker-signing'> Signing Docker images </a> </li><li class='separator' /><li> <a href='/documentation/artifact-configuration'> Artifact Configuration </a> </li><li> <a href='/documentation/build-system-integration'> Build System Integration </a> </li><li> <a href='/documentation/trusted-build-systems'> Trusted Build Systems </a> </li><li> <a href='/documentation/origin-verification'> Origin Verification </a> </li><li class='separator' /><li> <a href='/documentation/powershell'> PowerShell cmdlets </a> </li></ul>
            </li><li>
              <a href='/about-us'> About us </a>
              <ul><li> <a href='/company'> Company </a> </li><li> <a href='/blog'> Blog </a> </li><li> <a href='/jobs'> Jobs </a> </li><li> <a href='/contact'> Contact </a> </li></ul>
            </li><li class='login'><a class='btn btn-flat' href='https://fqa.test.signpath.io/Web/Home/Login'>Login</a>
          <li class='login'><a href='https://fqa.test.signpath.io/Web/Subscription/StartFreeTrial' class='btn btn-primary trial'>Start free trial</a></li>
          </li>
        </ul>
        <a id='main-menu-toggle' href='#' onclick='document.querySelector("header > div > nav > ul").classList.toggle("open")'>
          <div></div>
          <div></div>
          <div></div>
        </a>
      </nav>
    </div>
  </header>
  <main><section class="bg-blue font-white top-section">
	<div>
		<h1> Microsoft Office Macro Signing</h1>
	</div>
</section>
<section class="resources-section">
	<div><aside>
				<ul><li class=''>
							<a href='/product/features#'>Features</a></li><li class=''>
							<a href='/product/editions#'>Editions</a></li><li class='separator' /><li class=''>
							<a href='/product/devops#'>For DevOps teams</a></li><li class=''>
							<a href='/product/infosec#'>For InfoSec teams</a></li><li class=''>
							<a href='/product/open-source#'>For Open Source projects</a></li><li class='separator' /><li class='active'>
							<a href='/product/office-macros#'>Office macro signing</a><div class="no-mobile" ><ul>
  <li><a href="#the-threat-of-office-macros">The Threat of Office Macros</a></li>
  <li><a href="#implement-macro-signing-to-create-secure-end-user-policies">Implement Macro Signing to Create Secure End User Policies</a></li>
  <li><a href="#inadequacy-of-existing-approaches">Inadequacy of Existing Approaches</a></li>
  <li><a href="#end-to-end-security-for-office-macros">End-to-End Security for Office Macros</a></li>
  <li><a href="#certificate-scopes-global-vs-departmental-execution-permissions">Certificate scopes: global vs. departmental execution permissions</a></li>
</ul>
</div></li><li class=''>
							<a href='/product/pkic-best-practices#'>PKI Consortium best practices</a></li><li class='separator' /><li class=''>
							<a href='/product/changelog#'>Product updates</a></li></ul>
			</aside><article><ul class="article-toc mobile-only">
  <li><a href="#the-threat-of-office-macros">The Threat of Office Macros</a></li>
  <li><a href="#implement-macro-signing-to-create-secure-end-user-policies">Implement Macro Signing to Create Secure End User Policies</a></li>
  <li><a href="#inadequacy-of-existing-approaches">Inadequacy of Existing Approaches</a></li>
  <li><a href="#end-to-end-security-for-office-macros">End-to-End Security for Office Macros</a></li>
  <li><a href="#certificate-scopes-global-vs-departmental-execution-permissions">Certificate scopes: global vs. departmental execution permissions</a></li>
</ul>
<h2 id="the-threat-of-office-macros">The Threat of Office Macros</h2>

<p>While many organizations depend on <strong>Microsoft Office macros for business-critical processes</strong>, they pose a <strong>high risk for IT security</strong>. Macros are programs within Office documents that <strong>execute with the same permissions as the user</strong> opening the document. Not to speak of macros that use other exploits to elevate their privileges even beyond that. That makes Office macros a preferred way for hackers to get into organizations, with attacks ranging from <strong>ransomware</strong> to <strong>spear phishing</strong>.</p>

<p>Unlike normal programs, Office documents are often opened by users without thinking twice. Enabling macro execution is then just a click away, which is especially easy to achieve via <strong>social engineering</strong> by including instructions in an email or even the document itself.</p>

<p>Also unlike normal programs, administrators find it <strong>almost impossible to provide policy settings</strong> that define which macros may be executed. Policy frameworks such as <strong>application control/whitelisting don’t work for macros</strong>. And malware scanners will always miss some malevolent macros.</p>

<h2 id="implement-macro-signing-to-create-secure-end-user-policies">Implement Macro Signing to Create Secure End User Policies</h2>

<p><strong>Digitally signing your organization’s macros will unlock the policy capabilities of Microsoft Office:</strong></p>

<ul>
  <li>Use group policies to allow execution only for macros signed with trusted certificates</li>
  <li>Assign trusted certificates to users and groups</li>
</ul>

<p><img src="/assets/img/product/office-macros/office-supported-apps.png" alt="Supported applications: Excel, PowerPoint, Project, Publisher, Visio, Word" /></p>

<p><strong>Using SignPath, you can keep your signing keys safe and easily create well-defined signing processes for each of these certificates.</strong></p>

<h2 id="inadequacy-of-existing-approaches">Inadequacy of Existing Approaches</h2>

<p>This table shows how readily available policies provide <strong>inadequate security</strong> and/or <strong>impact the business</strong> to an unacceptable degree:</p>

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Security level</th>
      <th>Implementation</th>
      <th>Business impact</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Enable macro execution</td>
      <td>🔴</td>
      <td>🟢</td>
      <td>🟢</td>
      <td>This should never be enabled</td>
    </tr>
    <tr>
      <td>Let users decide whether to execute macros</td>
      <td>🟠</td>
      <td>🟢</td>
      <td>🟢</td>
      <td>You cannot rely on users <em>always</em> making the right decision</td>
    </tr>
    <tr>
      <td>Disable macro execution except for digitally signed macros</td>
      <td>🟡</td>
      <td>🟠</td>
      <td>🟢</td>
      <td>Digital signing in Office is a manual activity and requires private key access for macro authors from their development PCs</td>
    </tr>
    <tr>
      <td>Disable macro execution except for users who require them</td>
      <td>🟡</td>
      <td>🔴</td>
      <td>🟠</td>
      <td>Each of these users still poses a risk, and they often add up</td>
    </tr>
    <tr>
      <td>Disable macro execution except for certain storage locations</td>
      <td>🟡</td>
      <td>🟡</td>
      <td>🟡</td>
      <td>This will mitigate direct internet/email attacks, but still any user can drop a malicious document in a trusted location</td>
    </tr>
    <tr>
      <td>Disable macro execution for everyone</td>
      <td>🟢</td>
      <td>🟢</td>
      <td>🔴</td>
      <td>Very safe but often unrealistic</td>
    </tr>
    <tr>
      <td><strong>Using SignPath:</strong> <br /> Disable macro execution except for digitally signed macros</td>
      <td>🟢</td>
      <td>🟢</td>
      <td>🟢</td>
      <td>Provide a secure process that aligns signing authorization and approval policies with macro execution policies.</td>
    </tr>
  </tbody>
</table>

<h2 id="end-to-end-security-for-office-macros">End-to-End Security for Office Macros</h2>

<p>Macros signing is easy to set up using the policy framework provided by SignPath:</p>

<ul>
  <li>VBA developers create and edit macros in office documents and document templates</li>
  <li>Macros are signed manually or automatically using SignPath</li>
  <li>Administrators set up signing permissions and approval rules</li>
</ul>

<p>For approved macros, this process has no impact on business units using Office documents:</p>

<ul>
  <li>Users can create new documents and view, edit and save data in existing documents without affecting signed macros</li>
  <li>Documents can be stored in any location and shared via email</li>
</ul>

<p><img src="/assets/img/product/office-macros/macro-signing-process.png" alt="Macro signing process" /></p>

<h2 id="certificate-scopes-global-vs-departmental-execution-permissions">Certificate scopes: global vs. departmental execution permissions</h2>

<p>Once you have set up a signing policy for your organization, you can disable execution of unsigned macros via Microsoft Office group policies.</p>

<h3 id="fine-tune-signing-and-execution-permissions">Fine-tune signing and execution permissions</h3>

<p>Some organizations need more fine-grained control over macro execution. In this case you can assign <strong>specific macro signing certificates</strong> to departments.</p>

<table>
  <thead>
    <tr>
      <th>Department</th>
      <th>Trusted certificates</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Finance</td>
      <td>Global, Finance</td>
    </tr>
    <tr>
      <td>Legal</td>
      <td>Legal</td>
    </tr>
    <tr>
      <td>Engineering</td>
      <td>Global, Engineering, some subcontractors</td>
    </tr>
    <tr>
      <td>Restricted users</td>
      <td>none</td>
    </tr>
    <tr>
      <td>Everyone else</td>
      <td>Global</td>
    </tr>
  </tbody>
</table>

<p>Adjust your signing policies accordingly, e.g. provide signing permissions for the <em>Finance</em> certificate only to macro authors supposed to create Office macros for the finance departement.</p>

<h3 id="business-partners-and-customers">Business partners and customers</h3>

<p>For documents that are used outside of your organization, you can use your EV code signing certificate. External users, such as business partners or customers, will be informed that macros have been signed by your organizations. They can then decide to trust these macros on a per-user basis or through their own policy framework.</p>

		</article>
	</div>
</section><!-- last_modified_at:  --><section class='bg-dark-grey font-white newsletter' id="newsletter">
	<div>
		<h2>Sign up for news and special offers</h2>
		<form class="ml-block-form" action="https://app.mailerlite.com/webforms/submit/d7c3i1" data-code="d7c3i1" method="post">
			<input type="text" class="form-control" data-inputmask="" name="fields[name]" value="" placeholder="Name">
			<input type="email" class="form-control" data-inputmask="" name="fields[email]" value="" placeholder="Email">
			<input type="hidden" name="ml-submit" value="1">
			<button type="submit" class="btn btn-secondary newsletter">Subscribe</button>
		</form>
	</div>
</section>
</main>
  <footer>
  	<div>
	  	<div>
	  		<img src='/assets/logo.svg' width="334" height="67" alt='SignPath'/>
	  		<svg viewBox="0 0 244 18">
			  <text x="0" y="15">CODE SIGNING SIMPLE &amp; SECURE</text>
			</svg>
	  		<div>
				<a target="_blank" href="https://twitter.com/SignPathIO/" rel="noopener noreferrer"><svg class="icon footer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757813 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820313 12.292969 C 11.726563 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195313 13.722656 C 6.386719 13.695313 5.628906 13.476563 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914063 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039063 9.136719 21.460938 11.289063 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539063 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z"/></svg>
</a>
				&nbsp;&nbsp;
				<a target="_blank" href="mailto:info@signpath.io" rel="noopener noreferrer"><svg class="icon footer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 3 8 L 3 26 L 29 26 L 29 8 Z M 7.3125 10 L 24.6875 10 L 16 15.78125 Z M 5 10.875 L 15.4375 17.84375 L 16 18.1875 L 16.5625 17.84375 L 27 10.875 L 27 24 L 5 24 Z"/></svg>
</div>
	  	</div>
	  	<div>
	  		<a href='/privacy-policy'>Privacy Policy</a>
	  		<a href='/terms-of-service'>Terms of Service</a>
	  		<a href='/status'><span style="color: lightgreen;"><svg class="icon small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"/></svg>
</span>Status
			</a>
	  	</div>
	</div>
  </footer>
        <div id='cookie-info'>
            <h3>Cookie settings</h3>
            <div class="container">
                <span>We use cookies to enhance your browsing experience.</span>
                <p class="mobile show-more active"><a>Show more information</a></p>
                <p class="mobile show-less"><a>Show less information</a></p>
                <span class="information">By clicking the “Accept” button below, you agree that non-essential cookies on our website may be used by us and by third parties, some of them located in the USA. Learn more about our cookies in our <a
                            href='/privacy-policy'>Privacy
					Policy</a>
                </span>
				<div class="actions">
					<button class='btn btn-primary' id='acknowledge-cookies-btn'>Accept</button>
					<button class="btn btn-grey" id='refuse-cookies-btn'>Refuse</button>
				</div>
            </div>
			<script>
				const queryString = window.location.search;
				const urlParams = new URLSearchParams(queryString);
				const adgroupid = urlParams.get('adgroupid') ? urlParams.get('adgroupid') : document.cookie.match('(^|;)\\s*' + 'adgroupid' + '\\s*=\\s*([^;]+)')?.pop() || ''

				if (adgroupid) {
					const els_trial = document.querySelectorAll("a[href='" + window.location.protocol + '//' + window.location.hostname + '/Web/Subscription/StartFreeTrial' + "']")
					const els_login = document.querySelectorAll("a[href='" + window.location.protocol + '//' + window.location.hostname + '/Web/Home/Login' + "']");

					for (let child of els_trial) {
						if (child.tagName === 'A') {
							child.href = child.href + '?websiteCorrelationId=' + adgroupid
						}
					}

					for (let child of els_login) {
						if (child.tagName === 'A') {
							child.href = child.href + '?websiteCorrelationId=' + adgroupid
						}
					}
				}
			</script>
		</div>
	</footer>
</body>
</html>
