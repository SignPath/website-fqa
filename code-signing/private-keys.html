<!-- last_modified_at:  --><!DOCTYPE html>
<html lang="en" data-appurl='https://fqa.test.signpath.io'>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="canonical" href='https://signpath.github.io/website-staging//code-signing/private-keys' />
  <!-- Begin Jekyll SEO tag v2.6.1 -->
  <link rel='preload' as='style' href='/assets/css/line-awesome.min.css' onload="this.rel='stylesheet'">
  <title>Storage of Private Keys | SignPath</title>
  <meta property="og:title" content="Storage of Private Keys | SignPath" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:description" content="How do key storage and management practices affect the security of your code signing process?" />
  <meta property="og:url" content="https://signpath.github.io/website-staging//code-signing/private-keys" />
  <meta property="og:site_name" content="SignPath.io" />
  <meta name="description" content="How do key storage and management practices affect the security of your code signing process?"/>
  <!-- End Jekyll SEO tag -->
  <link rel='stylesheet' href='/assets/css/hint.min.css'>
  <link rel="stylesheet" href="/assets/css/index.css?cache=2024-12-18">
  <link rel="alternate" type="application/atom+xml" title="SignPath.io Blog" href="/feed.xml">
  <script src='/assets/index.js?cache=2024-12-18'></script>
  <script src='/assets/js/main-bundle.js?cache=2025-03-06'></script><link rel="icon" href="/assets/favicon-50x50.png" sizes="32x32">
  <link rel="icon" href="/assets/favicon.png" sizes="192x192">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.png">
  <meta name="msapplication-TileImage" content="/assets/favicon.png">
</head>
<body>
  <header>
    <div>
      <a href='/'><img src='/assets/signpath-logo-white.svg' width="181" height="36" alt='SignPath'></a>
      <nav>
        <ul><li>
              <a href='/product'> Product</a>
              <ul><li> <a href='/product/features'> Features </a> </li><li> <a href='/product/editions'> Editions </a> </li><li class='separator' /><li> <a href='/product/devops'> For DevOps teams </a> </li><li> <a href='/product/infosec'> For InfoSec teams </a> </li><li> <a href='/product/open-source'> For Open Source projects </a> </li><li class='separator' /><li> <a href='/product/office-macros'> Office macro signing </a> </li><li> <a href='/product/thales-dpod'> Thales DPoD Cloud HSM </a> </li><li> <a href='/product/pkic-best-practices'> PKI Consortium best practices </a> </li></ul>
            </li><li>
              <a href='/code-signing'> Code Signing</a>
              <ul><li> <a href='/code-signing/introduction'> Introduction </a> </li><li> <a href='/code-signing/theory'> Theory </a> </li><li> <a href='/code-signing/windows-platform'> Windows Platform </a> </li><li> <a href='/code-signing/test-certificates'> Managing Test Certificates </a> </li><li> <a href='/code-signing/private-keys'> Storage of Private Keys </a> </li><li> <a href='/code-signing/media-coverage'> Media Coverage </a> </li></ul>
            </li><li>
              <a href='/documentation'> Documentation</a>
              <ul><li> <a href='/documentation/getting-started'> Getting Started </a> </li><li> <a href='/documentation/managing-certificates'> Managing Certificates </a> </li><li> <a href='/documentation/users'> Managing Users </a> </li><li> <a href='/documentation/projects'> Setting up Projects </a> </li><li> <a href='/documentation/signing-code'> Signing Code </a> </li><li> <a href='/documentation/signing-containers'> Signing Container Images </a> </li><li class='separator' /><li> <a href='/documentation/artifact-configuration'> Artifact Configuration </a> </li><li> <a href='/documentation/build-system-integration'> Build System Integration </a> </li><li> <a href='/documentation/trusted-build-systems'> Trusted Build Systems </a> </li><li> <a href='/documentation/origin-verification'> Origin Verification </a> </li><li class='separator' /><li> <a href='/documentation/powershell'> PowerShell cmdlets </a> </li><li> <a href='/documentation/crypto-providers'> Crypto Providers </a> </li><li class='separator' /><li> <a href='/documentation/changelog'> Product updates </a> </li></ul>
            </li><li>
              <a href='/about-us'> About us</a>
              <ul><li> <a href='/company'> Company </a> </li><li> <a href='/team'> Team </a> </li><li> <a href='/blog'> Blog </a> </li><li> <a href='/jobs'> Jobs </a> </li><li> <a href='/support'> Support </a> </li><li> <a href='/contact'> Contact </a> </li></ul>
            </li><li class='search'>
            <div>
              <div>
                <form method="get" target="_self" action="/search">
                  <input type='search' name='q' placeholder="Search SignPath.io" />
                </form>
              </div>
            </div>
            <span tabindex='0'>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M 19 3 C 13.488281 3 9 7.488281 9 13 C 9 15.394531 9.839844 17.589844 11.25 19.3125 L 3.28125 27.28125 L 4.71875 28.71875 L 12.6875 20.75 C 14.410156 22.160156 16.605469 23 19 23 C 24.511719 23 29 18.511719 29 13 C 29 7.488281 24.511719 3 19 3 Z M 19 5 C 23.429688 5 27 8.570313 27 13 C 27 17.429688 23.429688 21 19 21 C 14.570313 21 11 17.429688 11 13 C 11 8.570313 14.570313 5 19 5 Z"/></svg>
            </span>
          </li>
          <li class='login'><a class='btn btn-flat' href='https://fqa.test.signpath.io/Web/Home/Login'>Login</a>
          <li class='login'><a href='https://fqa.test.signpath.io/Web/Subscription/StartFreeTrial' class='btn btn-primary trial'>Start free trial</a></li>
          </li>
        </ul>
        <a id='main-menu-toggle' href='#' onclick='document.querySelector("header > div > nav > ul").classList.toggle("open")'>
          <div></div>
          <div></div>
          <div></div>
        </a>
      </nav>
    </div>
  </header>
  <main>
<section class="bg-blue font-white top-section resources-header">
	<div>
		<h1><span class='no-break'><a href='/code-signing'>Code Signing</a>&nbsp;&nbsp;❯&nbsp;&nbsp;</span><span class='no-break'>Storage of Private Keys</span></h1>
	</div>
</section><section class="resources-section ">
	<div><nav class='hidden-on-mobile'><ul class=''><li class=' '>
							<a href='/code-signing/introduction#'>Introduction</a></li><li class=' '>
							<a href='/code-signing/theory#'>Theory</a></li><li class=' '>
							<a href='/code-signing/windows-platform#'>Windows Platform</a></li><li class=' '>
							<a href='/code-signing/test-certificates#'>Managing Test Certificates</a></li><li class='active '>
							<a href='/code-signing/private-keys#'>Storage of Private Keys</a></li><li class=' '>
							<a href='/code-signing/media-coverage#'>Media Coverage</a></li></ul>
			</nav><div class='content'><ul class="article-toc">
  <li><a href="#overview">Overview</a></li>
  <li><a href="#pfx-files-with-private-keys">PFX files with private keys</a></li>
  <li><a href="#windows-certificate-store">Windows certificate store</a></li>
  <li><a href="#usb-hsm-tokens">USB HSM tokens</a></li>
  <li><a href="#professional-hsms">Professional HSMs</a></li>
</ul>
<article>
					<h2 id="overview">Overview</h2>

<p>How do you keep your keys secure? There are a number of ways to store your private keys, but only hardware security modules (HSMs) guarantee that the private key cannot be extracted:</p>

<ul>
  <li><a href="#pfx-files-with-private-keys">PFX files with private keys</a></li>
  <li><a href="#windows-certificate-store">Windows certificate store</a></li>
  <li><a href="#usb-hsm-tokens">USB HSM tokens</a></li>
  <li><a href="#professional-hsms">Professional HSMs</a></li>
</ul>

<blockquote class="panel info">
  <p><strong>EV and OV certificates</strong></p>

  <p>Extended Validation (EV) certificates are only available with HSMs. While Organization Validated (OV) certificates can still be obtained from many Certificate Authorities without hardware protection, this is considered insecure.</p>
</blockquote>

<h2 id="pfx-files-with-private-keys">PFX files with private keys</h2>

<h3 id="risks">Risks</h3>

<ul>
  <li>A brute force attack on the PFX password might successfully retrieve your private key.
    <ul>
      <li>Depending on the entropy of your password and the password cipher your PFX file uses.</li>
      <li>The PFX format does not prescribe a specific cipher.</li>
      <li>Also, some files use a weak cipher for the container and a strong cipher for the private key with the same encryption key, so a brute force attack on the weak cipher will also reveal the encryption key for the private key.</li>
    </ul>
  </li>
  <li>If your password leaks, your private key is accessible to everyone who has access to the PFX file.
    <ul>
      <li>In general, memorizable passwords are unsafe, and high-entropy passwords need to be stored securely.</li>
      <li>It is very tempting for development and DevOps teams to store PFX files in accessible locations such as file servers or source code repositories. Also, PFX passwords might be stored in build scripts and batch files.</li>
      <li>This basically shifts the burden from private key secrecy to password secrecy.</li>
    </ul>
  </li>
  <li>Sometimes PFX files are considered secure because they are only used for certificate installation. However, even a temporary exposure of the PFX file (e.g. via file shares, backup media or e-mail storage) will nullify this assumption.</li>
  <li>Key theft or abuse cannot be detected.</li>
</ul>

<h3 id="verdict">Verdict</h3>

<p>Does not meet basic security requirements.</p>

<h2 id="windows-certificate-store">Windows certificate store</h2>

<h3 id="risks-1">Risks</h3>

<ul>
  <li>Certificates can be installed on machines without allowing key export. However, this relies on DPAPI storage, which relies on password secrecy and supports several restore options. DPAPI should not be trusted to keep secrets from people with access to the computer or disk, whether physical or remote, running or at rest.</li>
  <li>While DPAPI supports a certain level of event logging, this is intended for troubleshooting, not security.</li>
  <li>While CryptoAPI (which is used by Microsoft’s signing tools) provides logging, it is up to the computer’s administrator to ensure that logging is enabled, that logs are stored for a defined period, and that logs cannot be truncated and will not roll over.</li>
  <li>Even if the private key cannot be obtained as clear text, it can still be used by authorized users and services to create unwanted signatures.</li>
  <li>Key theft or abuse cannot be detected reliably.</li>
</ul>

<h3 id="verdict-1">Verdict</h3>

<ul>
  <li>Some resistance against key theft, but unlikely to withstand professional attacks.</li>
  <li>Limited control over key usage.</li>
</ul>

<h2 id="usb-hsm-tokens">USB HSM tokens</h2>

<h3 id="assumptions">Assumptions</h3>

<ul>
  <li>FIPS 140-2 Level 2 or higher.</li>
  <li>Certificates are either pre-installed on the USB-token by the CA, or the certificates are created via a CSR from a private key that was generated by the device.</li>
</ul>

<h3 id="remaining-risks">Remaining risks</h3>

<ul>
  <li>While the private key cannot be retrieved from the USB device, the device itself must be kept secure. Since USB devices can easily be removed, this basically rules out permanent installation on build machines unless additional physical security measures are taken.</li>
  <li>Access to private keys is usually protected with proprietary password protection. Password entry is usually designed for manual usage scenarios such as authentication or signing of documents. USB HSM tokens do not usually provide secure authentication for automated scenarios.</li>
  <li>Unless the USB device has a proprietary logging mechanism, key abuse cannot be detected.</li>
</ul>

<h3 id="verdict-2">Verdict</h3>

<ul>
  <li>Persistent key theft requires physical access and is easily detected</li>
  <li>Limited control over key usage. Dependency on secret password or PIN in case of physical access or access to the computer.</li>
</ul>

<h2 id="professional-hsms">Professional HSMs</h2>

<h3 id="assumptions-1">Assumptions</h3>

<ul>
  <li>FIPS 140-2 Level 2 or higher.</li>
  <li>Certificates are created via a CSR from a private key that was generated by the device.</li>
</ul>

<h3 id="remaining-risks-1">Remaining risks</h3>

<ul>
  <li>Depending on connectivity, the HSM is always available on the network or on the computer where it is installed, access to the HSM must be constrained to ensure that only authorized users and services can use the private keys of code signing certificates.</li>
  <li>Additional measures are necessary in order to ensure that only valid signings are performed, especially in scenarios where many users, services or computers have access to the HSM.
    <ul>
      <li>Consider that developers, build engineers and test engineers often have extensive permission on build environments for troubleshooting, including remote access. In this case, it is easy to perform unmonitored and unaudited code signings.</li>
    </ul>
  </li>
  <li>While secure logging is usually provided by HSMs, the resulting low-level log entries are hard to correlate to code signings, especially in scenarios where multiple software artifacts are signed for a single software release.</li>
</ul>

<h3 id="verdict-3">Verdict</h3>

<ul>
  <li>Key theft impossible if security procedures are followed.</li>
  <li>Limited control over key usage.</li>
  <li>Auditing is possible but difficult to monitor without process alignment.</li>
</ul>

<p>HSMs are required for EV certificates for a reason, and strongly recommended for any code signing implementation. However, their security advantages come with a price.</p>

<ul>
  <li>High TCO for professional HSMs
    <ul>
      <li>Considerable hardware cost</li>
      <li>Vendor training for HSM operators</li>
      <li>Elaborate administrative procedures for secure operation, often requiring physical presence of several operators</li>
    </ul>
  </li>
  <li>Dependency on physical device access for non-network devices (USB or PCI)
    <ul>
      <li>Only network HSMs can be shared in distributed build systems</li>
    </ul>
  </li>
  <li>Dependency on installation of vendor CSPs <em>(CryptoAPI Cryptographic Service Providers)</em>
    <ul>
      <li>Note that CryptoAPI is a legacy technology, so vendor CSPs are sometimes outdated and poorly supported. However, most code signing mechanisms by Microsoft including Authenticode cannot use the more modern <em>Cryptography API: Next Generation</em> (CNG) model.</li>
    </ul>
  </li>
</ul>

				</article>
			</div>
	</div>
</section><!-- last_modified_at:  --><section class='bg-dark-grey font-white newsletter' id="newsletter">
	<div>
		<h2>Sign up for news and special offers</h2>
		<form class="ml-block-form" action="https://app.mailerlite.com/webforms/submit/d7c3i1" data-code="d7c3i1" method="post">
			<input type="text" class="form-control" data-inputmask="" name="fields[name]" value="" placeholder="Name">
			<input type="email" class="form-control" data-inputmask="" name="fields[email]" value="" placeholder="Email">
			<input type="hidden" name="ml-submit" value="1">
			<button type="submit" class="btn btn-secondary newsletter">Subscribe</button>
		</form>
	</div>
</section>
</main>
  <footer>
  	<div>
	  	<div>
	  		<img src='/assets/signpath-logo-white.svg' width="334" height="67" alt='SignPath'/>
	  		<svg viewBox="0 0 244 18">
			  <text x="0" y="15" textLength="244" lengthAdjust="spacingAndGlyphs">CODE SIGNING SIMPLE &amp; SECURE</text>
			</svg>
	  		<div>
				<a target="_blank" href="https://www.linkedin.com/company/33243108" rel="noopener noreferrer">
<svg class="icon footer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor"  d="M 8.6425781 4 C 7.1835781 4 6 5.181625 6 6.640625 C 6 8.099625 7.182625 9.3085938 8.640625 9.3085938 C 10.098625 9.3085938 11.283203 8.099625 11.283203 6.640625 C 11.283203 5.182625 10.101578 4 8.6425781 4 z M 21.535156 11 C 19.316156 11 18.0465 12.160453 17.4375 13.314453 L 17.373047 13.314453 L 17.373047 11.310547 L 13 11.310547 L 13 26 L 17.556641 26 L 17.556641 18.728516 C 17.556641 16.812516 17.701266 14.960938 20.072266 14.960938 C 22.409266 14.960937 22.443359 17.145609 22.443359 18.849609 L 22.443359 26 L 26.994141 26 L 27 26 L 27 17.931641 C 27 13.983641 26.151156 11 21.535156 11 z M 6.3632812 11.310547 L 6.3632812 26 L 10.923828 26 L 10.923828 11.310547 L 6.3632812 11.310547 z"/></svg></a>
				&nbsp;&nbsp;
				<a target="_blank" href="mailto:info@signpath.io" rel="noopener noreferrer"><svg class="icon footer" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 3 8 L 3 26 L 29 26 L 29 8 Z M 7.3125 10 L 24.6875 10 L 16 15.78125 Z M 5 10.875 L 15.4375 17.84375 L 16 18.1875 L 16.5625 17.84375 L 27 10.875 L 27 24 L 5 24 Z"/></svg>
</div>
	  	</div>
	  	<div>
	  		<a href='/privacy-policy'>Privacy Policy</a>
	  		<a href='/terms-of-service'>Terms of Service</a>
	  		<a href='/status'><span style="color: lightgreen;"><svg class="icon small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="currentColor" d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"/></svg>
</span>Status
			</a>
	  	</div>
	</div>
  </footer>
        <div id='cookie-info'>
            <h3>Cookie settings</h3>
            <div class="container">
                <span>We use cookies to enhance your browsing experience.</span>
                <p class="mobile show-more active"><a>Show more information</a></p>
                <p class="mobile show-less"><a>Show less information</a></p>
                <span class="information">By clicking the “Accept” button below, you agree that non-essential cookies on our website may be used by us and by third parties, some of them located in the USA. Learn more about our cookies in our <a
                            href='/privacy-policy'>Privacy
					Policy</a>
                </span>
				<div class="actions">
					<button class='btn btn-primary' id='acknowledge-cookies-btn'>Accept</button>
					<button class="btn btn-grey" id='refuse-cookies-btn'>Refuse</button>
				</div>
            </div>
			<script>
				const queryString = window.location.search;
				const urlParams = new URLSearchParams(queryString);
				const adgroupid = urlParams.get('adgroupid') ? urlParams.get('adgroupid') : document.cookie.match('(^|;)\\s*' + 'adgroupid' + '\\s*=\\s*([^;]+)')?.pop() || ''

				if (adgroupid) {
					const els_trial = document.querySelectorAll("a[href='" + window.location.protocol + '//' + window.location.hostname + '/Web/Subscription/StartFreeTrial' + "']")
					const els_login = document.querySelectorAll("a[href='" + window.location.protocol + '//' + window.location.hostname + '/Web/Home/Login' + "']");

					for (let child of els_trial) {
						if (child.tagName === 'A') {
							child.href = child.href + '?websiteCorrelationId=' + adgroupid
						}
					}

					for (let child of els_login) {
						if (child.tagName === 'A') {
							child.href = child.href + '?websiteCorrelationId=' + adgroupid
						}
					}
				}
			</script>
		</div>
	</footer>
</body>
</html>
